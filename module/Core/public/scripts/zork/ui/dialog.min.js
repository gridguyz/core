(function(c,d,e){if(typeof e.ui.dialog!=="undefined"){return}var f=[];var b=0;var a=function(j){e.style("/styles/scripts/dialog.css");var k,g;if(j instanceof d||Object.isElement(j)){j=d(j);k=j.attr("id");if(!k){j.attr("id",k="js-dialog-"+(++b))}var h={buttons:{}};d("input[type=reset], input[type=button], input[type=submit], button",j).each(function(){var l=d(this);h.buttons[l.val()||l.html()]=function(){l.click();d(this).dialog("destroy");d(this).remove()}}).remove();if(d.isEmptyObject(h.buttons)){h.buttons[e.core.translate("default.ok")]=function(){d(this).dialog("destroy");d(this).remove()}}if(!j.attr("title")){j.attr("title",a.defaultParams.title)}g=j.remove().removeClass("ui-helper-hidden").dialog(h)}else{j=d.extend({},a.defaultParams,j);if(typeof j.id!=="undefined"){k=j.id;delete j.id;var i=d("#"+k);if(i.size()>=0){a.destroy(k)}}else{k="js-dialog-"+(++b)}g=d('<div id="'+k+'" />');if(j.message instanceof d||Object.isElement(j.message)){g.append(d(j.message).remove())}else{g.html(String(j.message))}g.attr("title",j.title);d("body").append(g);g.dialog(j)}f.unshift(k);g.parents(".ui-dialog").addClass("js-dialog-container");return k};a.isElementConstructor=true;a.version="1.0";a.modulePrefix=["zork","core"];a.defaultParams={message:"",title:d("head > title").text()};a.getLastId=function(g){return f[g||0]};a.getNextId=function(){return"js-dialog-"+(1+b)};a.alert=function(h){h=d.extend({},a.defaultParams,h);h.modal=true;h.resizable=false;var g=h.ok;if(typeof h.ok!=="undefined"){delete h.ok}if(typeof h.buttons==="undefined"){h.buttons={}}if(typeof h.buttonLabel==="undefined"){h.buttonLabel=e.core.translate("default.ok")}h.buttons[h.buttonLabel]=function(){d(this).dialog("destroy");if(Function.isFunction(g)){g()}d(this).remove()};delete h.buttonLabel;a(h)};a.progress=function(g){g=d.extend({},a.progress.defaultParams,g);g.modal=true;g.resizable=false;a(g)};a.progress.defaultParams={title:e.core.translate("default.workInProgress"),message:e.core.translate("default.pleaseWait")};a.frame=function(k){var h,j,g,i=false;if(Object.isElement(k)||k instanceof d){h=d(k);k={autoOpen:false,id:h.data("jsDialogFrameId"),name:h.data("jsDialogFrameName"),url:h.data("jsDialogFrameUrl"),refresh:!!h.data("jsDialogFrameRefresh"),bind:h.data("jsDialogFrameBind"),width:h.data("jsDialogWidth")||600,height:h.data("jsDialogHeight")||400,closeOnEscape:h.data("jsDialogCloseOnEscape"),draggable:h.data("jsDialogDraggable"),closeText:h.data("jsDialogCloseText")||null,dialogClass:h.data("jsDialogClass")||"",hide:h.data("jsDialogHide")||"",modal:h.data("jsDialogModal"),resizable:!!h.data("jsDialogResizable"),show:h.data("jsDialogShow")||"",position:h.data("jsDialogPosition")||null,stack:h.data("jsDialogStack"),title:h.data("jsDialogTitle")||h.attr("title")||a.defaultParams.title,zIndex:h.data("jsDialogZIndex")||1000,buttons:[]};if(Object.isUndefined(k.closeOnEscape)){k.closeOnEscape=true}if(Object.isUndefined(k.draggable)){k.draggable=true}if(Object.isUndefined(k.stack)){k.stack=true}if(Object.isUndefined(k.modal)){k.modal=true}if(typeof k.position=="string"&&~k.position.indexOf(",")){k.position=k.position.split(",")}else{if(k.position!==null&&typeof k.position.of!="undefined"){k.position.of=c}}h.find("button, input[type=button]").each(function(){var l=d(this);k.buttons.push({text:l.text()||l.val(),click:function(){var m=d.Event("click");l.trigger(m);if(j&&!m.isDefaultPrevented()){d("#"+j).dialog("close")}}})});if(!k.url){if(h.is("a")){k.url=h.attr("href")}else{if(h.is("form")){k.url=h.attr("action");if(!k.bind){k.bind="submit"}}else{k.url=h.attr("href")||h.attr("src")}}}h.on(k.bind||"click",function(){if(j){d("#"+j).dialog("open")}return false})}if(k.refresh){i=true;delete k.refresh}if(k.url){k.id=k.id||k.name||e.generateId();k.name=k.name||k.id;k.message=a.frame.template.replace(/\{id\}/ig,k.id).replace(/\{name\}/ig,k.name).replace(/\{url\}/ig,k.url).replace(/\{width\}/ig,(Number(k.width)||600)-50).replace(/\{height\}/ig,(Number(k.height)||400)-50);g=k.url;delete k.id;delete k.name;delete k.url;j=a(k);if(i){d("#"+j).on("dialogclose",function(){d(this).find("iframe:first").attr("src",g)})}return j}return null};a.frame.template='<iframe id="{id}" name="{name}" src="{url}" frameborder="0" allowtransparency="true" style="border: none; background: transparent; width: {width}px; height: {height}px;"></iframe>';a.frame.isElementConstructor=true;a.ajax=function(m){var i,k,h,l,g,j=false;if(Object.isElement(m)||m instanceof d){i=d(m);m={autoOpen:false,url:i.data("jsDialogAjaxUrl"),refresh:!!i.data("jsDialogAjaxRefresh"),bind:i.data("jsDialogAjaxBind"),width:i.data("jsDialogWidth")||600,height:i.data("jsDialogHeight")||400,closeOnEscape:i.data("jsDialogCloseOnEscape"),draggable:i.data("jsDialogDraggable"),closeText:i.data("jsDialogCloseText")||null,dialogClass:i.data("jsDialogClass")||"",hide:i.data("jsDialogHide")||"",modal:i.data("jsDialogModal"),resizable:!!i.data("jsDialogResizable"),show:i.data("jsDialogShow")||"",position:i.data("jsDialogPosition")||null,stack:i.data("jsDialogStack"),title:i.data("jsDialogTitle")||i.attr("title")||a.defaultParams.title,zIndex:i.data("jsDialogZIndex")||1000,buttons:[]};if(Object.isUndefined(m.closeOnEscape)){m.closeOnEscape=true}if(Object.isUndefined(m.draggable)){m.draggable=true}if(Object.isUndefined(m.stack)){m.stack=true}if(Object.isUndefined(m.modal)){m.modal=true}if(typeof m.position=="string"&&~m.position.indexOf(",")){m.position=m.position.split(",")}else{if(m.position!==null&&typeof m.position.of!="undefined"){m.position.of=c}}i.find("button, input[type=button]").each(function(){var n=d(this);m.buttons.push({text:n.text()||n.val(),click:function(){var o=d.Event("click");n.trigger(o);if(k&&!o.isDefaultPrevented()){d("#"+k).dialog("close")}}})});if(!m.url){if(i.is("a")){m.url=i.attr("href")}else{if(i.is("form")){m.url=i.attr("action");if(!m.bind){m.bind="submit"}}else{m.url=i.attr("href")||i.attr("src")}}}i.on(m.bind||"click",function(){if(k){d("#"+k).dialog("open")}return false})}if(m.refresh){j=true;delete m.refresh}if(m.url){h=m.url;delete m.url;g=function(o){if(k){d("#"+k).html(o)}else{m.message=o;k=a(m);if(j){d("#"+k).on("dialogclose",l)}}var n=Object.clone(m.buttons);d("#"+k).find("form button, form input[type=button], form input[type=submit]").each(function(){var p=d(this).hide();n.push({text:p.text()||p.val(),click:function(){var q=d.Event("click");p.trigger(q);if(k&&!q.isDefaultPrevented()){d("#"+k).dialog("close")}}})});d("#"+k).dialog("option","buttons",n);e.core.parseDocument("#"+k)};l=function(){d.ajax({url:h,async:true,cache:false,success:g,dataType:"text",error:function(){g(e.core.translate("default.error"))}})};l();return null}return null};a.ajax.isElementConstructor=true;a.confirm=function(j){if(Object.isUndefined(j)){j={}}else{if(typeof j=="string"){j={message:j}}else{if(Object.isElement(j)||j instanceof d){j={element:j}}}}if(!j.message){delete j.message}j=d.extend({},a.defaultParams,{message:e.core.translate("default.areYouSure")},j);var i=j.yes,h=j.no,g=j.element;if(typeof j.yes!=="undefined"){delete j.yes}if(typeof j.no!=="undefined"){delete j.no}if(typeof j.element!=="undefined"){delete j.element}if(typeof j.buttons==="undefined"){j.buttons={}}if(typeof j.noLabel==="undefined"){j.noLabel=e.core.translate("default.no")}j.buttons[j.noLabel]=function(){d(this).dialog("destroy");if(Function.isFunction(h)){h()}d(this).remove()};if(typeof j.yesLabel==="undefined"){j.yesLabel=e.core.translate("default.yes")}j.buttons[j.yesLabel]=function(){d(this).dialog("destroy");if(Function.isFunction(i)){i()}if(Object.isElement(g)){g.setAttribute("onclick","");g.onclick=function(){};g=d(g);if(g.is("a, link")){c.location.href=g.attr("href")}g[0].click()}d(this).remove()};delete j.noLabel;delete j.yesLabel;j.modal=true;a(j);return false};a.prompt=function(k){k=d.extend({},a.defaultParams,k);var i=d('<input type="text" />'),l=k.input,j=k.cancel,h=typeof k.defaultValue!=="undefined"?String(k.defaultValue):"",g=null;if(typeof k.input!=="undefined"){delete k.input}if(typeof k.cancel!=="undefined"){delete k.cancel}if(typeof k.defaultValue!=="undefined"){delete k.defaultValue}k.message=d("<div />").append(Object(k.message) instanceof String?d("<p />").html(k.message):k.message).append(d("<p />").css("text-align","center").append(i));if(typeof k.buttons==="undefined"){k.buttons={}}if(typeof k.cancelLabel==="undefined"){k.cancelLabel=e.core.translate("default.cancel")}k.buttons[k.cancelLabel]=function(){d(this).dialog("destroy");if(Function.isFunction(j)){j()}d(this).remove()};if(typeof k.okLabel==="undefined"){k.okLabel=e.core.translate("default.ok")}k.buttons[k.okLabel]=function(){var m=d("#"+g+" input").val();d(this).dialog("destroy");if(Function.isFunction(l)){l(m)}d(this).remove()};delete k.okLabel;delete k.cancelLabel;k.modal=true;a(k);g=a.getLastId();i.keypress(function(n){if(Number(n.which)===13){var m=String(this.value);d("#"+g).dialog("destroy");if(Function.isFunction(l)){l(m)}d(this).remove()}}).val(h).focus()};a.ask=function(l){l=d.extend({},a.defaultParams,l);var k=d([]),o=l.input,r=l.cancel,p=typeof l.inputs!=="undefined"?l.inputs:{},t=null,n=null,m=null,s=null,h=d("<dl />"),g=e.generateId()+"-",q=function(){var i={};for(n in p){if(!Object.isUndefined(p,n)){if(p[n].type=="select-multiple"){i[n]=[];d("#"+g+n).find(":input:checked").each(function(){i[n].push(this.value)})}else{i[n]=d("#"+g+n).val()}}}return i};if(typeof l.input!=="undefined"){delete l.input}if(typeof l.cancel!=="undefined"){delete l.cancel}if(typeof l.inputs!=="undefined"){delete l.inputs}l.message=d("<div />").append(l.message);for(n in p){if(!Object.isUndefined(p,n)){h.append('<dt><label for="'+g+n+'">'+(p[n].label||n)+"</label></dt>");if(p[n].type=="select-multiple"){s=d('<div id="'+g+n+'" />').css({display:"inline-block","text-align":"left"});if(!Array.isArray(p[n]["default"])){p[n]["default"]=[String(p[n]["default"])]}if(Array.isArray(p[n].options)){p[n].options.forEach(function(i){s.append('<label><input type="checkbox" name="'+n+'[]" value="'+i+'"'+(p[n]["default"].indexOf(i)>=0?' checked="checked"':"")+">"+i+"</label>");s.append("<br />")})}else{for(m in p[n].options){if(!Object.isUndefined(p[n].options,m)){s.append('<label><input type="checkbox" name="'+n+'[]" value="'+m+'"'+(p[n]["default"].indexOf(m)>=0?' checked="checked"':"")+">"+p[n].options[m]+"</label>");s.append("<br />")}}}}else{if(p[n].type=="select-one"){s=d('<select id="'+g+n+'" name="'+n+'" />');if(Array.isArray(p[n].options)){p[n].options.forEach(function(i){s.append('<option value="'+i+'"'+(i==p[n]["default"]?' selected="selected"':"")+">"+i+"</option>")})}else{for(m in p[n].options){if(!Object.isUndefined(p[n].options,m)){s.append('<option value="'+m+'"'+(m==p[n]["default"]?' selected="selected"':"")+">"+p[n].options[m]+"</option>")}}}}else{if(p[n].type=="textarea"){s=d('<textarea id="'+g+n+'" name="'+n+'" />').val(p[n]["default"])}else{s=d('<input type="'+p[n].type+'" id="'+g+n+'" name="'+n+'"'+(typeof p[n].checked!=="undefined"&&p[n].checked?' checked="checked"':"")+'value="'+String(p[n]["default"]||"").replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")+'" />')}}}h.append(d("<dd />").append(s))}}l.message.append(h);if(typeof l.buttons==="undefined"){l.buttons={}}if(typeof l.cancelLabel==="undefined"){l.cancelLabel=e.core.translate("default.cancel")}l.buttons[l.cancelLabel]=function(){d(this).dialog("destroy");if(Function.isFunction(r)){r()}d(this).remove()};if(typeof l.okLabel==="undefined"){l.okLabel=e.core.translate("default.ok")}l.buttons[l.okLabel]=function(){var i=q();d(this).dialog("destroy");if(Function.isFunction(o)){o(i)}d(this).remove()};delete l.okLabel;delete l.cancelLabel;l.modal=true;a(l);t=a.getLastId();d("#"+t+" :input").keypress(function(j){if(Number(j.which)===13){var i=q();d("#"+t).dialog("destroy");if(Function.isFunction(o)){o(i)}d(this).remove()}}).first().focus()};a.destroy=function(g){if(g&&c.document.getElementById(g)){d("#"+g).dialog("destroy");d("#"+g).remove();return g}while(f.length>0){g=f.shift();if(c.document.getElementById(g)){d("#"+g).dialog("destroy");d("#"+g).remove();return g}}return null};c.Zork.Ui.prototype.dialog=a}(window,jQuery,zork));